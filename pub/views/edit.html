
<style>
	.panel-update {
		box-shadow: rgba(0, 0, 0, 0.0745098) 0px 1px 1px 0px inset, rgba(102, 175, 232, 0.52549) 0px 0px 6.99039793014526px 0px;
		border-color: rgb(106, 176, 232);
	}
</style>

<div id="main-panel" class="panel panel-default fade" ng-class="{in:ready}">
  <div class="panel-heading clearfix">



	<div class="btn-group">
	  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
	    Menu <span class="caret"></span>
	  </button>
	  <ul class="dropdown-menu" role="menu">

	    <li><a href="" ng-click="labels=!labels" ng-hide="labels">
      	<span class="glyphicon glyphicon-tag"/> &nbsp; Show names
	    </a></li>
	    <li><a href="" ng-click="labels=!labels" ng-show="labels">
      	<span class="glyphicon glyphicon-tag"/> &nbsp; Hide names
	    </a></li>
	    <li><a href="" ng-click="columnsUp()">
	      <span class="glyphicon glyphicon-th-large"/> &nbsp; Columns view
	    </a></li>

	    <li class="divider"></li>

	    <li><a href="" ng-show="!starred && !new" ng-click="star()">
      	<span class="glyphicon glyphicon-star"/> &nbsp; Star
      </a></li>
      <li><a href="" ng-show="starred  && !new" ng-click="star()">
      	<span class="glyphicon glyphicon-star"/> &nbsp; Un-star
      </a></li>

	    <li class="divider"></li>

	    <li><a href="" ng-click="delete()" ng-show="!new">
	    	<span class="glyphicon glyphicon-trash"/> &nbsp; Delete document
	    </a></li>

	    <li><a href="" ng-click="template()" ng-show="!new">
	    	<span class="glyphicon glyphicon-pencil"/> &nbsp; Edit template
	    </a></li>

	    <li><a href="" ng-click="raw()" ng-show="!new">
	    	<span class="glyphicon glyphicon-wrench"/> &nbsp; Show RAW
	    </a></li>

	    <li><a href="" ng-show="!new" ng-click="save()">
	      <span class="glyphicon glyphicon-floppy-disk"/> &nbsp; Save now
	    </a></li>

	  </ul>
	</div>
    
    <button class="btn btn-default pull-right" ng-click="close()">
      <span class="glyphicon glyphicon-remove"></span>
    </button>

    <style>
    h4 {
      display: inline-block;
      margin-left: 10px;
    }
    </style>

    <style ng-if="!labels">label {display: none;}</style>

    <h4 class="hidden-xs">{{doc._id}}</h4>

  </div>

  <style>
    
    .clean-inputs > div > .form-control {
      border: 0px solid white;
      box-shadow: none;
      border-bottom: 1px dashed #ddd;
      border-radius: 0;
    }

    .clean-inputs > div > .form-control[disabled="disabled"]{
      cursor: default;
      background-color: white;
      opacity: 1;
    }

  </style>

  <!-- Google Maps -->
  <style>
    .angular-google-map-container { height: 200px; }

    .angular-google-map {

    }

    .angular-google-map-container {
      border-radius: 8px;
      border: 1px solid black;
    }

  </style>


  <!-- panel-body -->
  <div class="panel-body doc">
  
      <div class="form-group col-sm-12" ng-show="new">
        <label class="control-label">_id</label>
        <div class="">
          <input type="text" class="form-control" ng-model="doc._id" ng-disabled="!new">
        </div>
      </div>

      <!-- Tag list -->
      <div class="form-group col-sm-12">
        <label class="control-label">tags</label>
        <div class="">
          <taginput ng-model="doc.tags" ng-disabled="!editing"></taginput>
        </div>
      </div>

      <!-- Template items -->
      <div class="form-group clean-inputs col-sm-{{columns}}" ng-repeat="field in doc.template track by field.name">
        <label class="control-label test">{{field.name}} <small>({{field.type}})</small></label>

        <!-- Primitive data types (should autosave on changes) -->
        <input      ng-change="autosaveEventually(field.name)" ng-blur="autosaveNow(field.name)" ng-if="field.type == 'text'"       ng-model="doc[field.name]" ng-disabled="!editing" type="text" class="form-control" placeholder="({{field.name}})">
        <input      ng-change="autosaveEventually(field.name)" ng-blur="autosaveNow(field.name)" ng-if="field.type == 'number'"     ng-model="doc[field.name]" ng-disabled="!editing" type="number" class="form-control" placeholder="({{field.name}})">
        <input      ng-change="autosaveEventually(field.name)" ng-blur="autosaveNow(field.name)" ng-if="field.type == 'date'"       ng-model="doc[field.name]" ng-disabled="!editing" type="date" class="form-control">
        <input      ng-change="autosaveEventually(field.name)" ng-blur="autosaveNow(field.name)" ng-if="field.type == 'time'"       ng-model="doc[field.name]" ng-disabled="!editing" type="time" class="form-control">
        <textarea   ng-change="autosaveEventually(field.name)" ng-blur="autosaveNow(field.name)" ng-if="field.type == 'textarea'"   ng-model="doc[field.name]" ng-disabled="!editing" class="form-control code" rows="9" placeholder="({{field.name}})" style="margin-bottom: -10px; font-size: small; font-family: monospace"></textarea>

        <javascript ng-if="field.type == 'javascript'" ng-model="doc[field.name]" ng-disabled="!editing" col="{{collection}}" id="{{id}}" script="{{field.name}}"></javascript>
        <rscript    ng-if="field.type == 'rscript'"    ng-model="doc[field.name]" ng-disabled="!editing" col="{{collection}}" id="{{id}}" script="{{field.name}}"></rscript>
        <timeslice  ng-if="field.type == 'timeslice'"  ng-model="doc[field.name]" ng-disabled="!editing" name="{{field.name}}"></timeslice>
        <reference  ng-if="field.type == 'reference'"  ng-model="doc[field.name]" ng-disabled="!editing" name="{{field.name}}"></reference>
        <tree       ng-if="field.type == 'tree'"       ng-model="doc[field.name]" ng-disabled="!editing" name="{{field.name}}"></tree>
        <process    ng-if="field.type == 'process'"    ng-model="doc[field.name]" ng-disabled="!editing" name="{{field.name}}"></process>

        <!-- Google Maps -->
        <ui-gmap-google-map ng-if="field.type == 'googlemaps'" center="doc[field.name].center" zoom="doc[field.name].zoom" options="doc[field.name].options"></ui-gmap-google-map>

        <!-- Timeseries -->
        <timeseries ng-if="field.type == 'timeseries'" ng-model="doc.data[field.name]"
          new         = "{{new}}"
          collection  = "{{collection}}"
          id          = "{{doc._id}}"
          timeseries  = "{{field.name}}"
          saving      = "saving"
          ng-disabled = "!editing">
        </timeseries>
     
      </div>

      <!-- Non-Template items -->
      <div class="form-group clean-inputs col-sm-{{columns}}" ng-repeat="(key, value) in doc" ng-if="additional(key)">
        <label class="control-label">{{key}}</label>
        <div class="">
          <input ng-change="autosaveEventually(key)" ng-blur="autosaveNow(key)" type="text"   class="form-control" ng-model="doc[key]" ng-disabled="!editing" placeholder="({{key}})">
        </div>
      </div>
      <!-- /Non-Template items -->

      <!-- New doc properties -->
      <div class="form-group col-sm-{{columns}}" ng-show="editing">
        <label class="control-label">
          new property:
        </label>
        <div class="">

          <div class="input-group">
            <input type="text" class="form-control" ng-model="newPropertyName" placeholder="(new property)">
            <div class="input-group-btn">
              <button type="submit" class="btn btn-default" ng-click="addProperty('text')" ng-disabled="!newPropertyOk()">Add</button>
              <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" ng-disabled="!newPropertyOk()"><span class="caret"></span></button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu">
                <li><a href="" ng-click="addProperty('textarea')">textarea</a></li>
                <li><a href="" ng-click="addProperty('number')">number</a></li>
                <li><a href="" ng-click="addProperty('date')">date</a></li>
                <li><a href="" ng-click="addProperty('time')">time</a></li>
                <li><a href="" ng-click="addProperty('timeslice')">timeslice</a></li>
                <li><a href="" ng-click="addProperty('reference')">reference</a></li>
                <li><a href="" ng-click="addProperty('timeseries')">timeseries</a></li>
                <li><a href="" ng-click="addProperty('javascript')">javascript</a></li>
                <li><a href="" ng-click="addProperty('rscript')">rscript</a></li>
                <li><a href="" ng-click="addProperty('googlemaps')">googlemaps</a></li>
                <li><a href="" ng-click="addProperty('tree')">tree</a></li>
                <li><a href="" ng-click="addProperty('process')">process</a></li>
                <li><a href="" ng-click="addProperty('hidden')">hidden</a></li>
              </ul>
            </div><!-- /btn-group -->
          </div><!-- /input-group -->

        </div>
      </div>
      <!-- /New doc properties -->

  </div> <!-- panel-body -->

  <!-- panel-footer -->
  <div class="panel-footer clearfix" ng-show="editing && new">


    <button ng-click="create()" type="submit" class="pull-right btn btn-primary">
      <span class="glyphicon glyphicon-floppy-disk"></span> Create
    </button>

    <div class="checkbox pull-right" style="margin-right: 20px">
        <input type="checkbox" ng-model="saveAsTemplate" ng-change="asTemplate()"> Create as template?
    </div>

  </div>
  <!-- /panel-footer -->

</div>

<!-- <pre>{{doc}}</pre> -->
